# 爬虫总结

## 一. 爬虫基础

### 1.1 http基本原理

### 1.2 request

1. request method(请求方式)
2. request url(请求链接)
3. request headers(请求头)
4. request body(请求体)
一般承载的内容是 POST 请求中的 Form Data，即表单数据，而对于 GET 请求 Request Body 则为空。

### 1.3 response

1. response status code
2. response headers
3. response body

## 二. 基本库的使用

### 2.1 urllib

```python
from urllib.parse import urlencode, parse_qs, quote, unquote

data = {
    'q':'知道',
    'name':'aa'
}
url = 'https://www.baidu.com?'

# urlencode() 方法将其序列化为 URL 标准 GET 请求参数
encode_data = urlencode(data)

print(url + encode_data)
# https://www.baidu.com?q=%E7%9F%A5%E9%81%93&name=aa

print(parse_qs(encode_data))
# {'q': ['知道'], 'name': ['aa']}

# 将内容转化为 URL 编码的格式
print(quote('知道'))
# %E7%9F%A5%E9%81%93
print(unquote(r'%E7%9F%A5%E9%81%93'))
```

### 2.2 requests

```python
from requests import Request, Session

url = 'http://httpbin.org/post'
data = {
    'name': 'germey'
}
headers = {
    'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.116 Safari/537.36'
}
s = Session()
req = Request('POST', url, data=data, headers=headers)
prepped = s.prepare_request(req)
r = s.send(prepped)
print(r.text)

```

> [request_基础](https://my-skills-book.readthedocs.io/en/latest/Python/Python%E7%9F%A5%E8%AF%86%E7%82%B9/request_%E5%9F%BA%E7%A1%80.html)


### 2.3 正则表达式

> [正则表达式实例](https://my-skills-book.readthedocs.io/en/latest/re/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%AE%9E%E4%BE%8B.html)

## 三. 解析库的使用

### 3.1 xpath

```python
from lxml import etree
text = '''
<li class="li li-first" name="item"><a href="link.html">first item</a></li>
'''
html = etree.HTML(text)
result = html.xpath('//li[contains(@class, "li") and @name="item"]/a/text()')
print(result)
# ['first item']
```

### 3.2 pyquery

```python
from pyquery import PyQuery as pq
doc = pq(html)
a = doc('a')
for item in a.items():
    print(item.attr('href'))
```

## 四. 数据存储

### 4.1 txt文本存储

### 4.2 json文件存储

- [json_解析json文件](https://my-skills-book.readthedocs.io/en/latest/Python/Python%E7%9F%A5%E8%AF%86%E7%82%B9/json_%E8%A7%A3%E6%9E%90json%E6%96%87%E4%BB%B6.html)

### 4.3 csv文件存储

- [csv_解析csv、tsv文件](https://my-skills-book.readthedocs.io/en/latest/Python/Python%E7%9F%A5%E8%AF%86%E7%82%B9/csv_%E8%A7%A3%E6%9E%90csv%E3%80%81tsv%E6%96%87%E4%BB%B6.html)

### 4.4 MySQL存储

- [MySql](https://my-skills-book.readthedocs.io/en/latest/databases/Mysql/index.html)

### 4.5 redis存储

- [redis](https://my-skills-book.readthedocs.io/en/latest/databases/Redis/index.html)

### 4.6 mongodb存储

- [mongodb](https://my-skills-book.readthedocs.io/en/latest/databases/Mongodb/index.html)